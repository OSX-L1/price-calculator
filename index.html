<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>โปรแกรมคำนวณราคาสินค้า</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.23/jspdf.plugin.autotable.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Kanit', sans-serif; }
        .tab-active { border-bottom-color: #3b82f6; color: #3b82f6; font-weight: 700; }
        .page-content { display: none; }
        .loader { border: 4px solid #f3f3f3; border-radius: 50%; border-top: 4px solid #3498db; width: 24px; height: 24px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="bg-slate-100 min-h-screen p-2 md:p-4">

<div class="w-full max-w-2xl mx-auto">
    <div class="mb-4 border-b border-slate-200 flex justify-between items-center">
        <nav class="-mb-px flex space-x-2 md:space-x-6" aria-label="Tabs">
            <button id="tab-blinds" class="nav-tab whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm text-slate-500 hover:text-blue-600 hover:border-blue-300 tab-active" data-page="page-blinds">คำนวณมู่ลี่</button>
        </nav>
    </div>
    <!-- ตัวอย่างเดียว: มู่ลี่ -->
    <div id="page-blinds" class="page-content bg-white rounded-2xl shadow-lg p-6 md:p-8" style="display:block">
        <div class="text-center mb-8"><h1 class="text-2xl md:text-3xl font-bold text-slate-800">คำนวณราคามู่ลี่อลูมิเนียม</h1></div>
        <div class="space-y-4">
            <div>
                <label for="blindsWidthInput" class="block font-medium text-slate-700 mb-1">ความกว้าง (ซม.)</label>
                <input type="number" id="blindsWidthInput" placeholder="ตัวอย่าง: 100" class="w-full px-4 py-3 bg-slate-50 border rounded-lg">
            </div>
            <div>
                <label for="blindsHeightInput" class="block font-medium text-slate-700 mb-1">ความสูง (ซม.)</label>
                <input type="number" id="blindsHeightInput" placeholder="ตัวอย่าง: 150" class="w-full px-4 py-3 bg-slate-50 border rounded-lg">
            </div>
            <div>
                <label for="blindsPriceInput" class="block font-medium text-slate-700 mb-1">ราคาต่อ ตร.ม. (บาท)</label>
                <input type="number" id="blindsPriceInput" placeholder="ตัวอย่าง: 450" class="w-full px-4 py-3 bg-slate-50 border rounded-lg">
            </div>
            <button id="blindsCalculateBtn" class="w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg">คำนวณราคา</button>
        </div>
        <div id="blindsResults" class="mt-8 hidden">
            <div class="bg-slate-50 rounded-lg p-6">
                <h2 class="text-xl font-bold text-center mb-4">ผลการคำนวณ</h2>
                <div class="space-y-2">
                    <div><span class="font-bold">ขนาด:</span> <span id="blindsSize"></span></div>
                    <div><span class="font-bold">พื้นที่ (ตร.ม.):</span> <span id="blindsArea"></span></div>
                    <div><span class="font-bold">ราคารวม:</span> <span id="blindsTotal" class="text-green-600 font-bold"></span> บาท</div>
                </div>
                <button id="blindsPdfBtn" class="mt-6 w-full bg-green-600 text-white font-bold py-3 px-4 rounded-lg">สร้าง PDF</button>
            </div>
        </div>
    </div>
</div>

<script>
// ฟอนต์ THSarabunNew (Base64, ตัดมาแค่บางส่วนเพื่อความยาว, แนะนำดาวน์โหลดไฟล์เต็มที่นี่: https://github.com/superpikar/jsPDF-Thai/blob/main/font/THSarabunNew-normal.js)
var THSarabunNew_Regular = 
'AAEAAAARAQAABAAQRFNJRwAAAAEAAc8AAAAVdEVYdAAAAAEAAGkAAAABdGV4dAAAAAEAAZAAAAAIZ2x5ZgAAABQAAEoAAABIZ2x5ZgAAABQAAEwAAABIZ2x5ZgAAABQAAE8AAABIZ2x5ZgAAABQAAFEAAABIZ2x5ZgAAABQAAFUAAABIZ2x5ZgAAABQAAFkAAABIZ2x5ZgAAABQAAFsAAABIZ2x5ZgAAABQAAFoAAABIZ2x5ZgAAABQAAFcAAABIZ2x5ZgAAABQAAFYAAABIZ2x5ZgAAABQAAFUAAABIZ2x5ZgAAABQAAFEAAABIZ2x5ZgAAABQAAE8AAABIZ2x5ZgAAABQAAEwAAABIZ2x5ZgAAABQAAEoAAABIZ2x5ZgAAABQAAc8AAACAZGVmYwAAAGAAAABkZXNjAAAAeAAAAGRlc2MAAAB4AAA='; // (สำหรับงานจริงควรใช้ไฟล์ base64 เต็ม)

// คำนวณและแสดงผล
document.getElementById('blindsCalculateBtn').onclick = function() {
    let w = parseFloat(document.getElementById('blindsWidthInput').value);
    let h = parseFloat(document.getElementById('blindsHeightInput').value);
    let price = parseFloat(document.getElementById('blindsPriceInput').value);
    if (isNaN(w) || isNaN(h) || isNaN(price) || w <= 0 || h <= 0 || price <= 0) {
        alert('กรุณากรอกข้อมูลให้ครบถ้วนและถูกต้อง');
        return;
    }
    let area = (w/100) * (h/100);
    let total = Math.round(area * price);
    document.getElementById('blindsSize').textContent = `${w} x ${h} ซม.`;
    document.getElementById('blindsArea').textContent = area.toFixed(2);
    document.getElementById('blindsTotal').textContent = total.toLocaleString('en-US');
    document.getElementById('blindsResults').classList.remove('hidden');
    // เก็บข้อมูลสำหรับ PDF
    window._blindsPdfData = {w, h, area, price, total};
};

// สร้าง PDF ภาษาไทย
document.getElementById('blindsPdfBtn').onclick = function() {
    if (!window._blindsPdfData) return;
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();
    // ฝังฟอนต์
    doc.addFileToVFS("THSarabunNew.ttf", THSarabunNew_Regular);
    doc.addFont("THSarabunNew.ttf", "THSarabunNew", "normal");
    doc.setFont("THSarabunNew", "normal");
    doc.setFontSize(22);
    doc.text("ใบเสนอราคามู่ลี่อลูมิเนียม", 105, 20, {align: 'center'});
    doc.setFontSize(16);
    doc.text(`ขนาด: ${window._blindsPdfData.w} x ${window._blindsPdfData.h} ซม.`, 20, 40);
    doc.text(`พื้นที่: ${window._blindsPdfData.area.toFixed(2)} ตร.ม.`, 20, 50);
    doc.text(`ราคาต่อ ตร.ม.: ${window._blindsPdfData.price.toLocaleString('en-US')} บาท`, 20, 60);
    doc.setFontSize(18);
    doc.text(`ราคารวมสุทธิ: ${window._blindsPdfData.total.toLocaleString('en-US')} บาท`, 20, 80);

    // ตัวอย่างตาราง
    doc.autoTable({
        startY: 100,
        head: [['รายละเอียด', 'ค่า']],
        body: [
            ['ขนาด (ซม.)', `${window._blindsPdfData.w} x ${window._blindsPdfData.h}`],
            ['พื้นที่ (ตร.ม.)', window._blindsPdfData.area.toFixed(2)],
            ['ราคาต่อ ตร.ม.', window._blindsPdfData.price.toLocaleString('en-US')],
            ['ราคารวม', window._blindsPdfData.total.toLocaleString('en-US')]
        ],
        styles: { font: "THSarabunNew", fontSize: 14 },
        headStyles: { font: "THSarabunNew", fontStyle: 'bold', fillColor: [22,160,133], textColor: 255 }
    });

    doc.save("ใบเสนอราคามู่ลี่.pdf");
};
</script>
</body>
</html>
